{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\NISHANTH\\\\Downloads\\\\Document_Signature_App_Skeleton\\\\signature-app\\\\client\\\\src\\\\pages\\\\ViewAndSign.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { Document, Page, pdfjs } from 'react-pdf';\nimport API from '../utils/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\npdfjs.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.min.js`;\nfunction ViewAndSign() {\n  _s();\n  const {\n    docId\n  } = useParams();\n  const navigate = useNavigate();\n  const [docUrl, setDocUrl] = useState('');\n  const [numPages, setNumPages] = useState(null);\n  const [signaturePosition, setSignaturePosition] = useState(null);\n  const fetchDocument = async () => {\n    try {\n      const res = await API.get(`/documents/${docId}`);\n      setDocUrl(`http://localhost:5000/${res.data.path}`);\n    } catch (err) {\n      console.error(err);\n      alert('Error loading document');\n      navigate('/dashboard');\n    }\n  };\n  useEffect(() => {\n    fetchDocument();\n  }, [docId]);\n  const onDocumentLoadSuccess = ({\n    numPages\n  }) => {\n    setNumPages(numPages);\n  };\n  const handlePlaceSignature = (e, pageNumber) => {\n    const rect = e.target.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const y = rect.bottom - e.clientY;\n    setSignaturePosition({\n      x,\n      y,\n      pageNumber\n    });\n  };\n  const handleSaveSignature = async () => {\n    if (!signaturePosition) {\n      alert('Please place the signature on the PDF first.');\n      return;\n    }\n    try {\n      await API.post('/signatures/add', {\n        docId,\n        ...signaturePosition\n      });\n      alert('Signature position saved successfully!');\n    } catch (err) {\n      console.error(err);\n      alert('Error saving signature position');\n    }\n  };\n  const handleFinalize = async () => {\n    try {\n      const signerIP = '127.0.0.1'; // Replace with real IP if needed\n      await API.post('/signatures/finalize', {\n        docId,\n        signerIP\n      });\n      alert('Document finalized with signature!');\n      navigate('/dashboard');\n    } catch (err) {\n      console.error(err);\n      alert('Error finalizing document');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-2xl mb-4\",\n      children: \"View and Sign Document\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), docUrl ? /*#__PURE__*/_jsxDEV(Document, {\n      file: docUrl,\n      onLoadSuccess: onDocumentLoadSuccess,\n      className: \"flex flex-col items-center\",\n      children: Array.from(new Array(numPages), (el, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative border mb-4\",\n        onClick: e => handlePlaceSignature(e, index + 1),\n        children: [/*#__PURE__*/_jsxDEV(Page, {\n          pageNumber: index + 1\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 15\n        }, this), signaturePosition && signaturePosition.pageNumber === index + 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute w-24 h-8 bg-blue-500 text-white text-xs flex items-center justify-center rounded shadow\",\n          style: {\n            left: signaturePosition.x,\n            bottom: signaturePosition.y,\n            transform: 'translate(-50%, 50%)',\n            pointerEvents: 'none'\n          },\n          children: \"Signature\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 17\n        }, this)]\n      }, `page_${index + 1}`, true, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading document...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex gap-4 mt-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleSaveSignature,\n        className: \"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600\",\n        children: \"Save Signature Position\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleFinalize,\n        className: \"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\",\n        children: \"Finalize Document\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 5\n  }, this);\n}\n_s(ViewAndSign, \"+jy6veiKGMpa79Vg4QepCs+TP0U=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = ViewAndSign;\nexport default ViewAndSign;\nvar _c;\n$RefreshReg$(_c, \"ViewAndSign\");","map":{"version":3,"names":["React","useEffect","useState","useParams","useNavigate","Document","Page","pdfjs","API","jsxDEV","_jsxDEV","GlobalWorkerOptions","workerSrc","version","ViewAndSign","_s","docId","navigate","docUrl","setDocUrl","numPages","setNumPages","signaturePosition","setSignaturePosition","fetchDocument","res","get","data","path","err","console","error","alert","onDocumentLoadSuccess","handlePlaceSignature","e","pageNumber","rect","target","getBoundingClientRect","x","clientX","left","y","bottom","clientY","handleSaveSignature","post","handleFinalize","signerIP","className","children","fileName","_jsxFileName","lineNumber","columnNumber","file","onLoadSuccess","Array","from","el","index","onClick","style","transform","pointerEvents","_c","$RefreshReg$"],"sources":["C:/Users/NISHANTH/Downloads/Document_Signature_App_Skeleton/signature-app/client/src/pages/ViewAndSign.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { Document, Page, pdfjs } from 'react-pdf';\r\nimport API from '../utils/api';\r\n\r\npdfjs.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.min.js`;\r\n\r\nfunction ViewAndSign() {\r\n  const { docId } = useParams();\r\n  const navigate = useNavigate();\r\n  const [docUrl, setDocUrl] = useState('');\r\n  const [numPages, setNumPages] = useState(null);\r\n  const [signaturePosition, setSignaturePosition] = useState(null);\r\n\r\n  const fetchDocument = async () => {\r\n    try {\r\n      const res = await API.get(`/documents/${docId}`);\r\n      setDocUrl(`http://localhost:5000/${res.data.path}`);\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert('Error loading document');\r\n      navigate('/dashboard');\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchDocument();\r\n  }, [docId]);\r\n\r\n  const onDocumentLoadSuccess = ({ numPages }) => {\r\n    setNumPages(numPages);\r\n  };\r\n\r\n  const handlePlaceSignature = (e, pageNumber) => {\r\n    const rect = e.target.getBoundingClientRect();\r\n    const x = e.clientX - rect.left;\r\n    const y = rect.bottom - e.clientY;\r\n    setSignaturePosition({ x, y, pageNumber });\r\n  };\r\n\r\n  const handleSaveSignature = async () => {\r\n    if (!signaturePosition) {\r\n      alert('Please place the signature on the PDF first.');\r\n      return;\r\n    }\r\n    try {\r\n      await API.post('/signatures/add', { docId, ...signaturePosition });\r\n      alert('Signature position saved successfully!');\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert('Error saving signature position');\r\n    }\r\n  };\r\n\r\n  const handleFinalize = async () => {\r\n    try {\r\n      const signerIP = '127.0.0.1'; // Replace with real IP if needed\r\n      await API.post('/signatures/finalize', { docId, signerIP });\r\n      alert('Document finalized with signature!');\r\n      navigate('/dashboard');\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert('Error finalizing document');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6\">\r\n      <h1 className=\"text-2xl mb-4\">View and Sign Document</h1>\r\n      {docUrl ? (\r\n        <Document\r\n          file={docUrl}\r\n          onLoadSuccess={onDocumentLoadSuccess}\r\n          className=\"flex flex-col items-center\"\r\n        >\r\n          {Array.from(new Array(numPages), (el, index) => (\r\n            <div\r\n              key={`page_${index + 1}`}\r\n              className=\"relative border mb-4\"\r\n              onClick={(e) => handlePlaceSignature(e, index + 1)}\r\n            >\r\n              <Page pageNumber={index + 1} />\r\n              {signaturePosition && signaturePosition.pageNumber === index + 1 && (\r\n                <div\r\n                  className=\"absolute w-24 h-8 bg-blue-500 text-white text-xs flex items-center justify-center rounded shadow\"\r\n                  style={{\r\n                    left: signaturePosition.x,\r\n                    bottom: signaturePosition.y,\r\n                    transform: 'translate(-50%, 50%)',\r\n                    pointerEvents: 'none',\r\n                  }}\r\n                >\r\n                  Signature\r\n                </div>\r\n              )}\r\n            </div>\r\n          ))}\r\n        </Document>\r\n      ) : (\r\n        <p>Loading document...</p>\r\n      )}\r\n      <div className=\"flex gap-4 mt-4\">\r\n        <button\r\n          onClick={handleSaveSignature}\r\n          className=\"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600\"\r\n        >\r\n          Save Signature Position\r\n        </button>\r\n        <button\r\n          onClick={handleFinalize}\r\n          className=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\"\r\n        >\r\n          Finalize Document\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ViewAndSign;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}